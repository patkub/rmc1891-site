<!--
@license
Copyright (c) 2017 Rogers Manufacturing Company. All rights reserved.
-->

<!doctype html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="Cache-Control" content="max-age=86400"/>
    <meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, user-scalable=yes">

    <title>RMC 1891</title>
    <meta name="description" content="Rogers Manufacturing Company">
    <meta name="author" content="Rogers Manufacturing Company">
    
    <!--
      If deploying to a non-root path, replace href="/" with the full path to the project root.
      For example: href="/polymer-starter-kit/relative-path-example/"
    -->
    <base href="/">

    <link rel="icon" href="images/favicon.ico">

    <!-- See https://goo.gl/OOhYW5 -->
    <link rel="manifest" href="manifest.json">

    <!-- See https://goo.gl/qRE0vM -->
    <meta name="theme-color" content="#f44336">

    <!-- Add to homescreen for Chrome on Android. Fallback for manifest.json -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="RMC 1891">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="RMC 1891">

    <!-- Homescreen icons -->
    <link rel="apple-touch-icon" href="images/manifest/icon-48x48.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/manifest/icon-72x72.png">
    <link rel="apple-touch-icon" sizes="96x96" href="images/manifest/icon-96x96.png">
    <link rel="apple-touch-icon" sizes="144x144" href="images/manifest/icon-144x144.png">
    <link rel="apple-touch-icon" sizes="192x192" href="images/manifest/icon-192x192.png">

    <!-- Tile icon for Windows 8 (144x144 + tile color) -->
    <meta name="msapplication-TileImage" content="images/manifest/icon-144x144.png">
    <meta name="msapplication-TileColor" content="#f44336">
    <meta name="msapplication-tap-highlight" content="no">
    
    <script>
      // Enable Shady DOM instead of default Shadow DOM
      window.ShadyDOM = {force: true};
      window.customElements.forcePolyfill = true;
      
      // Register the base URL
      const baseUrl = document.querySelector('base').href;

      // Load and register pre-caching Service Worker
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', function() {
          navigator.serviceWorker.register(baseUrl + 'sw.js');
        });
      }
    </script>

    <!-- Load webcomponents-lite.js to check and load any polyfills the browser needs -->
    <script src="node_modules/@npm-polymer/webcomponentsjs/webcomponents-loader.js"></script>

    <!-- RMC Theme CSS -->
    <link rel="stylesheet" href="css/rmc-theme.min.css">

    <!-- Bootstrap JS -->
    <script defer src="node_modules/jquery/dist/jquery.slim.min.js"></script>
    <script defer src="node_modules/tether/dist/js/tether.min.js"></script>
    <script defer src="node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
    
    <!-- RMC Shell -->
    <link async rel="import" href="src/rmc-shell.html">

</head>

<body>

    <header>
        <!-- navbar -->
        <nav class="navbar navbar-toggleable-md navbar-inverse bg-inverse fixed-top">
            <button class="navbar-toggler navbar-toggler-right"
                    type="button"
                    data-toggle="collapse"
                    data-target="#navbarSupportedContent"
                    aria-controls="navbarSupportedContent"
                    aria-expanded="false"
                    aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <a class="navbar-brand" href="/">RMC 1891</a>

            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <!-- padding -->
                <ul class="mr-auto"></ul>

                <ul class="nav navbar-nav">
                    
                    <!-- navbar items -->
                    <dom-bind>
                        <template>
                            <template is="dom-repeat" items="{{links}}" mutable-data>
                              <li class="nav-item">
                                  <a class$="nav-link {{item.active}}" href$="{{item.link}}" data-toggle="collapse" data-target=".navbar-collapse.show" style="white-space: nowrap">
                                  <span class$="fa fa-fw fa-{{item.icon}}" aria-hidden="true"></span> {{item.text}}</a>
                              </li>
                            </template>
                        </template>
                    </dom-bind>
                    
                </ul>
            </div>
        </nav>
        <!-- /navbar -->
    </header>

    <main>
        <rmc-shell></rmc-shell>
    </main>

    <!-- footer -->
    <rmc-footer text="Copyright &copy 2017 The Rogers Manufacturing Company."
                admin='{"text": "Admin", "link": "/admin/", "icon": "lock"}'></rmc-footer>
    
    <script>
        // auto-binding template
        let autobind = document.querySelector('dom-bind');

        // set links property
        autobind.links = [
            {text: 'Home', link: '/', icon: 'home', active: 'active'},
            {text: 'About', link: '/about/', icon: 'info', active: ''},
            {text: 'Capabilities', link: '/capabilities/', icon: 'cogs', active: ''},
            {text: 'Contact', link: '/contact/', icon: 'envelope', active: ''},
        ];
        
        // listen for page changed event and update active item
        document.querySelector('rmc-shell')
                .addEventListener('ActivePageChanged', function(e) {
            // clone the array
            autobind.links = autobind.links.slice();
        
            // change the active item
            for (let i = 0; i < autobind.links.length; i++) {
                if (autobind.links[i].text.toLowerCase() === e.detail.active) {
                    autobind.links[i].active = 'active';
                } else {
                    autobind.links[i].active = '';
                }
            }

            // notify the template of changes
            autobind.notifyPath('links');
        });
    </script>
    
</body>
</html>
